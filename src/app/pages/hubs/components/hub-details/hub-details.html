<section class="w-full h-1/2 p-2">
  <div
    class="bg-gray-200 size-full rounded-4xl overflow-clip border-0 relative"
  >
    <div class="flex absolute top-5 right-4 gap-2">
      <div
        class="p-2 flex items-center justify-center rounded-2xl bg-container"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="lucide lucide-heart-icon lucide-heart"
          [ngClass]="
            hub().available
              ? ['fill-white', 'stroke-text', 'opacity-90']
              : ['fill-amber-300/50', 'stroke-amber-300/60']
          "
        >
          <path
            d="M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5"
          />
        </svg>
      </div>
    </div>

    <img
      [src]="selectedImage() === '' ? hub().images?.[0] : selectedImage()"
      alt=""
      class="object-cover w-full h-full"
    />

    <div class="flex absolute bottom-5 left-4 gap-2 w-3/4">
      <div class="bg-amber-300/20 w-full backdrop-blur-sm px-3 py-1 rounded-sm">
        <h1 class="text-2xl font-bold text-text">{{ hub().title }}</h1>
        <p class="text-sm text-text flex gap-1 items-center">
          <span
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              width="15"
              height="15"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-map-pin-icon lucide-map-pin"
            >
              <path
                d="M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"
              />
              <circle cx="12" cy="10" r="3" /></svg></span
          >{{ hub().location }}
        </p>
        <p class="text-sm text-text flex gap-1 items-center">
          <span
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              width="15"
              height="15"
              viewBox="0 0 24 24"
              fill="none"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="stroke-amber-500"
            >
              <path
                d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"
              /></svg></span
          >4.5
        </p>
      </div>
    </div>
  </div>
</section>

<!-- Extra hub images -->
<section
  class="p-2 flex gap-2 w-full overflow-x-scroll [&::-webkit-scrollbar]:hidden [-ms-overflow-style:'none'] [scrollbar-width:none]"
>
  @for (img of hub().images; track $index) {
  <div
    class="bg-gray-200 h-24 min-w-36 rounded-2xl overflow-clip"
    (click)="selectImage(img)"
  >
    <img [src]="img" alt="" class="object-cover w-full h-full" />
  </div>
  }
</section>

<!-- Edit if its admin -->
<!-- @if (role() === 'admin') {
<div class="p-3 flex justify-end">
  <div class="flex items-center gap-3">
    <p>Edit Hub</p>
    <div class="relative inline-block w-11 h-5">
      <input
        id="switch-component"
        type="checkbox"
        [checked]="isToggled()"
        (change)="toggleChanged($event)"
        class="peer appearance-none w-11 h-5 bg-slate-100 rounded-full checked:bg-slate-800 cursor-pointer transition-colors duration-300"
      />
      <label
        for="switch-component"
        class="absolute top-0 left-0 w-5 h-5 bg-white rounded-full border border-slate-300 shadow-sm transition-transform duration-300 peer-checked:translate-x-6 peer-checked:border-slate-800 cursor-pointer"
      ></label>
    </div>
  </div>
</div>
}

<section class="pt-2 px-5 text-text">
  @if (isToggled()) {
  <form [formGroup]="eventForm" class="space-y-4 w-full">
    <div class="space-y-3">
      <p class="font-bold">Title</p>
      <input
        formControlName="title"
        class="border rounded p-1 text-shadow w-full"
        placeholder="Enter title"
      />
    </div>
    <div class="space-y-3">
      <p class="font-bold">Location</p>

      <input
        formControlName="location"
        class="border rounded p-1 w-full mt-2 text-shadow"
        placeholder="Enter location"
      />
    </div>

    <div class="space-y-3">
      <p class="font-bold">Availability</p>

      <select
        formControlName="available"
        class="border rounded p-1 text-shadow"
      >
        <option [ngValue]="true">Active</option>
        <option [ngValue]="false">Deactivated</option>
      </select>
    </div>

    <div class="space-y-3">
      <p class="font-bold">Description</p>

      <textarea
        formControlName="description"
        rows="6"
        class="border rounded p-2 w-full text-shadow"
      ></textarea>
    </div>

    <button
      (click)="saveChanges()"
      class="bg-text text-center w-full py-4 text-primary rounded-full mt-2"
    >
      Update
    </button>
  </form>
  }
</section> -->

<!-- review -->
<section class="pt-5 px-2">
  <!-- Add review button -->
  <div class="flex justify-end w-full">
    <button
      type="button"
      (click)="toggleAddReviewModal()"
      class="flex items-center w-[150px] py-2 px-3 gap-2 bg-amber-500 text-container rounded-sm hover:bg-amber-600 focus:outline-none transition-all"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="20"
        height="20"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
      >
        <path
          d="M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z"
        />
        <path d="m10 8-3 3 3 3" />
        <path d="m14 14 3-3-3-3" />
      </svg>
      <span>Add Review</span>
    </button>
  </div>

  <!-- Founder review section -->
  <div class="border bg-amber-300/10 border-amber-300/20 py-2 px-2 my-4">
    <!-- Founder details -->
    <div class="flex items-center gap-3 py-3">
      <div class="rounded-full size-14 overflow-clip">
        <img src="imgs/avatar.jpg" alt="house image" class="h-full w-full" />
      </div>

      <div>
        <p class="flex items-center gap-2 text-amber-700 text-sm">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="stroke-amber-700"
          >
            <path
              d="m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526"
            />
            <circle cx="12" cy="8" r="6" />
          </svg>
          <span>Discovered by</span>
        </p>
        <p class="text-text font-bold text-lg">Phillip Nzau</p>

        <p class="flex items-center text-gray-500 gap-2 text-sm">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="14"
            height="14"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-calendar1-icon lucide-calendar-1"
          >
            <path d="M11 14h1v4" />
            <path d="M16 2v4" />
            <path d="M3 10h18" />
            <path d="M8 2v4" />
            <rect x="3" y="4" width="18" height="18" rx="2" />
          </svg>
          <span> Added on July 11, 2025 </span>
        </p>
      </div>
    </div>

    <hr class="border-b border-gray-300/70" />

    <!-- Founder Review -->
    <div class="join join-vertical py-3 w-full">
      <div class="collapse collapse-arrow join-item text-text">
        <input type="checkbox" name="my-accordion-4" />
        <div
          class="collapse-title font-semibold flex items-center gap-2 border-b border-gray-300/70"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            aria-hidden="true"
          >
            <path
              d="M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z"
            />
            <path d="m10 8-3 3 3 3" />
            <path d="m14 14 3-3-3-3" />
          </svg>
          <p>View discoverer's full review</p>
        </div>
        <div class="collapse-content text-sm my-3">
          <div class="border-x border-b border-gray-300/70 p-3 text-text">
            <!-- Founder Rating -->
            <p class="text-sm text-gray-500 flex gap-1 items-center py-1">
              @for (item of [1,1,1,1,1]; track $index) {
              <span
                class="relative inline-block"
                [ngClass]="{
                  'text-gray-300': item
                }"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="15"
                  height="15"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="stroke-amber-500"
                  [ngClass]="{
                    'fill-rose-400': $index < 4,
                    'fill-none': $index === 4
                  }"
                >
                  <path
                    d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"
                  />
                </svg>
              </span>
              } 4/5
            </p>

            <!-- Founder Description -->
            <p class="py-3 border-b border-gray-300/70">
              Great spot for working with laptop. Good wifi and comfortable
              seating.
            </p>

            <p class="text-sm text-amber-700 py-1">
              Review added on July 11, 2025
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- More Reviews Accordion -->
  <div class="join join-vertical w-full my-1">
    <div
      class="collapse collapse-arrow join-item border border-gray-300/40 bg-amber-300/10 backdrop-blur-sm rounded-lg"
    >
      <!-- Accordion Trigger -->
      <input type="checkbox" name="reviews-accordion" />
      <div
        class="collapse-title text-md font-bold text-text flex items-center gap-2"
      >
        More reviews
      </div>

      <!-- Accordion Content -->
      <div class="collapse-content">
        @for (item of [1,1,1,1,1,1]; track $index) {
        <!-- Review Card -->
        <div
          class="border bg-amber-300/10 border-amber-300/20 py-2 px-2 my-4 rounded-md"
        >
          <!-- Reviewer Info -->
          <div class="flex items-center gap-3 py-3">
            <div class="rounded-full size-14 overflow-clip">
              <img
                src="imgs/avatar.jpg"
                alt="house image"
                class="h-full w-full"
              />
            </div>

            <div>
              <p class="text-text font-bold text-lg">John Doe</p>
              <p class="flex items-center text-gray-500 gap-2 text-sm">
                <span>Added on July 11, 2025</span>
              </p>
            </div>
          </div>

          <hr class="border-b border-gray-300/70" />

          <!-- Review Content -->
          <div class="text-sm my-3">
            <div class="border-x border-b border-gray-300/70 p-3 text-text">
              <!-- Rating -->
              <p class="text-sm text-gray-500 flex gap-1 items-center py-1">
                @for (item of [1,1,1,1,1]; track $index) {
                <span
                  class="relative inline-block"
                  [ngClass]="{
                    'text-gray-300': item
                  }"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="15"
                    height="15"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="stroke-amber-500"
                    [ngClass]="{
                      'fill-rose-400': $index < 4,
                      'fill-none': $index === 4
                    }"
                  >
                    <path
                      d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"
                    />
                  </svg>
                </span>
                } 4/5
              </p>

              <!-- Review Text -->
              <p class="py-3">
                Great spot for working with laptop. Good wifi and comfortable
                seating.
              </p>
            </div>
          </div>
        </div>
        }
      </div>
    </div>
  </div>
</section>

<!-- review modal -->
@if(isModal()) {
<app-modal (backdropClick)="toggleAddReviewModal()">
  <div class="w-full space-y-4 rounded-md p-5">
    <div class="flex items-center justify-between">
      <p class="text-xl font-bold">Review Hub</p>
      <button type="button" (click)="toggleAddReviewModal()">
        <svg
          width="37"
          height="36"
          viewBox="0 0 37 36"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <circle cx="18.5" cy="18" r="18" fill="#8eb69b" fill-opacity="0.2" />
          <path
            d="M24.7821 12.4329C24.6062 12.2566 24.3675 12.1576 24.1185 12.1576C23.8696 12.1576 23.6308 12.2566 23.455 12.4329L18.8527 17.0258L14.2503 12.4235C14.0745 12.2472 13.8357 12.1482 13.5868 12.1482C13.3378 12.1482 13.0991 12.2472 12.9232 12.4235C12.5562 12.7905 12.5562 13.3835 12.9232 13.7505L17.5256 18.3529L12.9232 22.9552C12.5562 23.3223 12.5562 23.9152 12.9232 24.2823C13.2903 24.6494 13.8832 24.6494 14.2503 24.2823L18.8527 19.6799L23.455 24.2823C23.8221 24.6494 24.415 24.6494 24.7821 24.2823C25.1491 23.9152 25.1491 23.3223 24.7821 22.9552L20.1797 18.3529L24.7821 13.7505C25.1397 13.3929 25.1397 12.7905 24.7821 12.4329Z"
            fill="#8eb69b"
          />
        </svg>
      </button>
    </div>
    <div class="flex flex-col items-center gap-4">
      <form [formGroup]="reviewHubForm" class="space-y-4 w-full py-6">
        <!-- Rating Field -->
        <div class="space-y-3">
          <p class="font-bold">Rating</p>
          <select
            formControlName="rating"
            class="border rounded p-1 text-shadow w-full"
          >
            <option value="">Select a rating</option>
            <option [ngValue]="1">1</option>
            <option [ngValue]="2">2</option>
            <option [ngValue]="3">3</option>
            <option [ngValue]="4">4</option>
            <option [ngValue]="5">5</option>
          </select>

          <!-- Rating Validation -->
          <p
            *ngIf="f.rating.touched && f.rating.errors?.['required']"
            class="text-rose-600 text-sm"
          >
            Rating is required.
          </p>
        </div>

        <!-- Description Field -->
        <div class="space-y-3">
          <p class="font-bold">Description</p>

          <textarea
            id="description"
            type="text"
            class="w-full border py-3 rounded-xl px-2 text-shadow outline-none"
            rows="3"
            cols="40"
            formControlName="description"
            placeholder="Write your review here (max 200 characters)"
          ></textarea>

          <!-- Description Validation -->
          <div class="flex justify-between text-sm">
            @if (f.description.touched && f.description.errors?.['required']) {
            <p class="text-rose-600">Description is required.</p>
            } @if (f.description.touched && f.description.errors?.['maxlength'])
            {
            <p class="text-rose-600">Maximum of 200 characters allowed.</p>
            }
            <!-- Character count -->
            <p
              class="text-gray-500 ml-auto"
              [class.text-rose-600]="descriptionLength > 200"
            >
              {{ descriptionLength }}/200
            </p>
          </div>
        </div>

        <!-- Submit Button -->
        <button
          (click)="submitReviewHub()"
          [disabled]="reviewHubForm.invalid"
          class="bg-text text-center w-full py-4 text-primary rounded-full disabled:opacity-50"
          type="button"
        >
          Add Review
        </button>
      </form>
    </div>
  </div>
</app-modal>
}
