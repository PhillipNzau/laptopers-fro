<section class="flex items-center justify-between pt-6 px-5 text-text">
  <div class="flex items-center gap-3">
    <svg
      width="32"
      height="32"
      viewBox="0 0 32 32"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M12.833 1.33301V5.33301"
        stroke="#C6E7DF"
        stroke-width="2.66667"
        stroke-linecap="round"
        stroke-linejoin="round"
      />
      <path
        d="M18.833 1.33301V5.33301"
        stroke="#C6E7DF"
        stroke-width="2.66667"
        stroke-linecap="round"
        stroke-linejoin="round"
      />
      <path
        d="M21.3333 10.6665C21.687 10.6665 22.0261 10.807 22.2761 11.057C22.5262 11.3071 22.6667 11.6462 22.6667 11.9998V22.6665C22.6667 24.081 22.1048 25.4375 21.1046 26.4377C20.1044 27.4379 18.7478 27.9998 17.3333 27.9998H9.33333C7.91885 27.9998 6.56229 27.4379 5.5621 26.4377C4.5619 25.4375 4 24.081 4 22.6665V11.9998C4 11.6462 4.14048 11.3071 4.39052 11.057C4.64057 10.807 4.97971 10.6665 5.33333 10.6665H24C25.4145 10.6665 26.771 11.2284 27.7712 12.2286C28.7714 13.2288 29.3333 14.5853 29.3333 15.9998C29.3333 17.4143 28.7714 18.7709 27.7712 19.7711C26.771 20.7713 25.4145 21.3332 24 21.3332H22.6667"
        stroke="#193730"
        stroke-width="2.66667"
        stroke-linecap="round"
        stroke-linejoin="round"
      />
      <path
        d="M7.83301 1.33301V5.33301"
        stroke="#C6E7DF"
        stroke-width="2.66667"
        stroke-linecap="round"
        stroke-linejoin="round"
      />
    </svg>

    <h1 class="text-2xl font-bold">LapTopers</h1>
  </div>
  <div (click)="toggleLayout()">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
      class="lucide lucide-gallery-vertical-end-icon lucide-gallery-vertical-end"
    >
      <path d="M7 2h10" />
      <path d="M5 6h14" />
      <rect width="18" height="12" x="3" y="10" rx="2" />
    </svg>
  </div>
</section>

<section class="pt-6 px-5 flex items-center justify-between gap-4">
  <div
    class="flex w-full bg-primary/40 items-center gap-1 py-2 px-3 rounded-xl text-text"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="20"
      height="20"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
      class="opacity-75"
    >
      <path d="m21 21-4.34-4.34" />
      <circle cx="11" cy="11" r="8" />
    </svg>
    <input
      type="search"
      placeholder="Search..."
      class="w-[20vw] bg-transparent px-3 text-sm placeholder:opacity-70 outline-none"
    />
  </div>

  <button
    (click)="toggleAddModal()"
    type="button"
    class="bg-text text-center w-[100px] py-2 text-primary rounded-full"
  >
    Add
  </button>
</section>

<section
  [ngClass]="{
    'grid-cols-1': isLayout(),
    'grid-cols-2': !isLayout()
  }"
  class="pt-6 px-4 text-text grid gap-4 mb-7"
>
  @for (item of hubs(); track $index) {
  <app-hub-card [hubData]="item" />
  }
</section>

<!-- add modal -->
@if(isModal()) {
<app-modal (backdropClick)="toggleAddModal()">
  <div class="w-full space-y-4 rounded-md p-5">
    <div class="flex items-center justify-between">
      <p class="text-xl font-bold">Add Hub</p>
      <button type="button" (click)="toggleAddModal()">
        <svg
          width="37"
          height="36"
          viewBox="0 0 37 36"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <circle cx="18.5" cy="18" r="18" fill="#8eb69b" fill-opacity="0.2" />
          <path
            d="M24.7821 12.4329C24.6062 12.2566 24.3675 12.1576 24.1185 12.1576C23.8696 12.1576 23.6308 12.2566 23.455 12.4329L18.8527 17.0258L14.2503 12.4235C14.0745 12.2472 13.8357 12.1482 13.5868 12.1482C13.3378 12.1482 13.0991 12.2472 12.9232 12.4235C12.5562 12.7905 12.5562 13.3835 12.9232 13.7505L17.5256 18.3529L12.9232 22.9552C12.5562 23.3223 12.5562 23.9152 12.9232 24.2823C13.2903 24.6494 13.8832 24.6494 14.2503 24.2823L18.8527 19.6799L23.455 24.2823C23.8221 24.6494 24.415 24.6494 24.7821 24.2823C25.1491 23.9152 25.1491 23.3223 24.7821 22.9552L20.1797 18.3529L24.7821 13.7505C25.1397 13.3929 25.1397 12.7905 24.7821 12.4329Z"
            fill="#8eb69b"
          />
        </svg>
      </button>
    </div>

    <div class="flex flex-col items-center gap-4">
      <form [formGroup]="createHubForm" class="space-y-4 w-full py-6">
        <div class="space-y-3">
          <p class="font-bold">Title</p>
          <input
            class="w-full border py-3 rounded-xl px-2 text-shadow outline-none"
            type="text"
            formControlName="title"
            id="title"
          />
          @if (f.title.touched && f.title.errors?.['required']) {
          <p class="text-rose-600">Title is required.</p>
          }
        </div>

        <div class="space-y-3">
          <p class="font-bold">Location</p>

          <input
            id="location"
            type="text"
            placeholder="Enter city or country"
            [formControl]="searchControl"
            class="h-14 w-full rounded-lg border border-themeMainColor px-6 text-base text-stone-900 placeholder-neutral-300 outline-none transition-all duration-200 focus:border-themeMainColor"
          />
        </div>
        @if (suggestions.length > 0) {
        <ul class="space-y-1 rounded-lg border border-themeMainColor p-1">
          @for (suggestion of suggestions; track suggestion) {
          <li
            class="hover: cursor-pointer rounded-lg border px-6 py-2 transition-all duration-200 hover:bg-purple-200"
            (click)="selectSuggestion(suggestion)"
          >
            {{ suggestion.display_name }}
          </li>
          }
        </ul>
        }

        <div class="space-y-3">
          <p class="font-bold">Description</p>

          <textarea
            id="description"
            type="text"
            class="w-full border py-3 rounded-xl px-2 text-shadow outline-none"
            rows="3"
            cols="40"
            formControlName="description"
          ></textarea>

          @if (f.description.touched && f.description.errors?.['required']) {
          <p class="text-rose-600">Description is required.</p>
          }
        </div>

        <div class="space-y-3">
          <p class="font-bold">Rating</p>
          <select
            formControlName="rating"
            class="border rounded p-1 text-shadow w-full"
          >
            <option [ngValue]="1">1</option>
            <option [ngValue]="2">2</option>
            <option [ngValue]="3">3</option>
            <option [ngValue]="4">4</option>
            <option [ngValue]="5">5</option>
          </select>
        </div>

        <!-- File Input -->
        <div class="space-y-3">
          <p class="font-bold">Upload Images</p>
          <input
            id="imageUpload"
            type="file"
            accept="image/*"
            multiple
            (change)="onImageSelected($event)"
            class="mb-4"
          />

          <div class="flex flex-wrap gap-4">
            @for (img of imagePreviews; track $index) {
            <div class="relative w-40 h-32">
              <img
                [src]="img"
                alt="Uploaded"
                class="object-cover w-full h-full rounded border"
              />
              <button
                type="button"
                (click)="removeImage($index)"
                class="absolute top-0 right-0 bg-red-600 text-white rounded-full p-1 m-1 text-xs size-5 flex items-center justify-center"
                aria-label="Remove image"
              >
                âœ•
              </button>
            </div>
            }
          </div>
        </div>

        <button
          (click)="submitCreateForm()"
          [disabled]="createHubForm.invalid"
          class="bg-text text-center w-full py-4 text-primary rounded-full disabled:opacity-50"
          type="button"
        >
          Add Hub
        </button>
      </form>
    </div>
  </div>
</app-modal>
}
